Процедура торговли такая: Сначала дожидаемся сигнала входа, совершаем покупку/продажу и сидим ждем сигнала выхода. Весь объем совершается сразу по сигналу входа, никаких докупок/допродаж в открытой позиции. Закрываем позицию также в одну заявку на продажу/покупку всего объема акций, на который была открыта позиция. Закрываем позицию по сигналу закрытия. Если возникает проскальзывание при закрытии, и заявка на закрытие не исполняется / исполняется в неполном объеме, закрываем позицию руками. Если происходит проскальзывание при открытии позиции,руками не входим, дожидаемся сигнала выхода, если заявка исполнена но не полностью либо дожидаемся сигнала входа, если заявка на открытие не исполнена вообще.
Сигналы входа:
Входящих сигнала два. Для открытия позиции необходимо выполнение всех сигналов сразу. Если один из сигналов входа не выполнен проверка остальных сигналов прекращается. Сигналы проверяются по порядку сверху вниз. Сигналы в процессе проверки могут устанавливать переменные, которые будут использоваться или изменяться при проверке других сигналов. Результатом проверки сигналов являются:
Факт истинного выполнения всех сигналов 
Направление торговли 
Объем торговли определяется оператором. Перед выполнением проверки сигналов направление торговли по умолчанию не определено.
Сигналы:
1. Сигнал проверяется на графике с дневными свечами: 
если торговый день еще не начался, то для выполнения сигнала на дневном графике две последние свечи должны быть направлены в одну сторону (обе растут или обе падают). Другими словами два предыдущих дня подряд цена идет в одну сторону. Направление торговли = направление этих свечей. При выполнении данного условия дальнейшая обработка сигнала прекращается. 
если торговый день начался, то для выполнения сигнала достаточно со направленности текущей свечи и предыдущей. Направление торговли = направление текущей свечи. 
2. Сигнал проверяется на графике с 5мин свечами. 
 Если все свечи от начала дня до текущей свечи со направленны с направлением торговли, определенным по первому сигналу и таких свечей (без учета текущей свечи) более 2х. то сигнал считается истинным. При выполнении условия дальнейшая обработка сигнала прекращается. 
Если в текущем дне на графике есть разнонаправленные свечи, то обработка сигнала разбивается на две стадии: 
Определить значение локального экстремума. Если направление торговли вверх (длинная позиция), то экстремумом принять максимум, если направление торговли вниз, то экстремум - это минимум. Свеча экстремума отличается от свечи не экстремума тем, что ее HIGH(на длинной)/LOW(на короткой) больше/меньше, чем HIGH/LOW любой из 3 левых и всех правых свечей, от свечи экстремума. Кроме того, справа от свечи экстремума должно быть не менее 4 полных свечей. Таким образом свеча экстремума находится минимум в 4 полных свечах от текущей свечи. Также, HIGH/LOW этой свечи должно быть больше/меньше, чем HIGH/LOW текущей свечи. За значение локального экстремума принять значение HIGH/LOW найденной свечи экстремума. Если свеча не была найдена значение сигнала принять ложным, и дальнейшую обработку сигналов прекратить. 
Дождаться пробоя локального экстремума с отступом. Тоесть должно выполниться условие
current >= extrem (+/-) padding
где: current - текущая цена, extrem - значение локального экстремума, padding - защитный отступ. Точный алгоритм определения защитного отступа не определен,  принимается оператором "на глаз". Можно лишь сказать, что зависит он от хождения цены акции, и должен повышать вероятность определения факта пробоя экстремума, но и не должен быть слишком большим, чтобы не получить большой убыток. Можно рассчитывать отступ, как 1/10 от средней высоты свечи для свечей между текущей и свечей экстремума.
Если произошел пробой локального экстремума, значение сигнала принять истинным и дальнейшую обработку сигнала прекратить. 
Сигналы выхода:
Выход из позиции осуществляется по алгоритму тейкпрофит+бэкстоп. По сути алгоритм состоит из одного сигнала и имеет следующий набор параметров:
бэкстоп 
тэйкпрофит 
тэйкпрофит отсту  
Определение параметров сигнала выполняется до проверки самого сигнала.
Бэкстоп выбирается так чтобы разница между бэкстопом и ценой открытия позиции не превышала 1/3 дневного интервала хождения цены (HIGH текущей дневной свечи минус LOW) а также, чтобы потеря не превышала 2% от объема сделки при прохождении ценой данного предела против позиции. Бэкстоп находиться против направления торговли от цены открытия тоесть ниже(на длинной)/выше(на короткой) чем цена открытия 
тэйкпрофит отступ равен половине разницы между ценой открытия и бэкстопом 
тэйкпрофит равен цена открытия (+/-) тэйкпрофит отступ (+/-) отступ безубытка. Отступ безубытка это величина при прохождении которой в сторону торговли NET составит 0 (комиссия съест прибыль от сделки). Комиссия для мамбы вычисляется по формуле ((0.54 * 2) + (open * count *0.002) + (close * count *0.002)) где open - цена открытия позиции, close - цена закрытия. 
Сам сигнал не описан потому как алгоритм бэкстоп + тэйкпрофит реализован в QUIK.

